import{_ as s,c as a,f as t,o as p}from"./app-BlilYjBv.js";const e={};function o(i,n){return p(),a("div",null,n[0]||(n[0]=[t(`<blockquote><p>本文介绍使用 WKWebView 拦截 url 进行原生界面跳转</p></blockquote><figure><img src="https://storage1.cuntuku.com/2017/05/27/3.gif" alt="3.gif" tabindex="0" loading="lazy"><figcaption>3.gif</figcaption></figure><ul><li>使用代理方法 decidePolicyForNavigationAction</li></ul><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>webView<span class="token punctuation">:</span><span class="token punctuation">(</span>WKWebView <span class="token operator">*</span><span class="token punctuation">)</span>webView decidePolicyForNavigationAction<span class="token punctuation">:</span><span class="token punctuation">(</span>WKNavigationAction <span class="token operator">*</span><span class="token punctuation">)</span>navigationAction decisionHandler<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">(</span>WKNavigationActionPolicy<span class="token punctuation">)</span><span class="token punctuation">)</span>decisionHandler <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 获取完整url并进行UTF-8转码</span></span>
<span class="line">    NSString <span class="token operator">*</span>strRequest <span class="token operator">=</span> <span class="token punctuation">[</span>navigationAction<span class="token punctuation">.</span>request<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>absoluteString stringByRemovingPercentEncoding<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>strRequest hasPrefix<span class="token punctuation">:</span><span class="token string">@&quot;app://&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 拦截点击链接</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token keyword">self</span> handleCustomAction<span class="token punctuation">:</span>strRequest<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// 不允许跳转</span></span>
<span class="line">      	<span class="token function">decisionHandler</span><span class="token punctuation">(</span>WKNavigationActionPolicyCancel<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    	<span class="token comment">// 允许跳转</span></span>
<span class="line">        <span class="token function">decisionHandler</span><span class="token punctuation">(</span>WKNavigationActionPolicyAllow<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>自定义方法传过来 url 进行判断，需要 html 元素本身就有跳转链接，才可以拦截，如没有，拦截不到。下文 app://xxx 链接为自定义链接</li></ul><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>handleCustomAction<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>URL</span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 判断跳转</span></span>
<span class="line">    NSString <span class="token operator">*</span>link_id <span class="token operator">=</span> <span class="token string">@&quot;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>URL hasPrefix<span class="token punctuation">:</span><span class="token string">@&quot;app://video&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 视频</span></span>
<span class="line">        <span class="token function">MMLog</span><span class="token punctuation">(</span><span class="token string">@&quot;点击了视频%@&quot;</span><span class="token punctuation">,</span>link_id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>URL hasPrefix<span class="token punctuation">:</span><span class="token string">@&quot;app://item&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 单品</span></span>
<span class="line">        <span class="token function">MMLog</span><span class="token punctuation">(</span><span class="token string">@&quot;点击了单品%@&quot;</span><span class="token punctuation">,</span>link_id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>URL hasPrefix<span class="token punctuation">:</span><span class="token string">@&quot;app://brand&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 品牌</span></span>
<span class="line">        link_id <span class="token operator">=</span> <span class="token punctuation">[</span>URL substringFromIndex<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;app://brand&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">MMLog</span><span class="token punctuation">(</span><span class="token string">@&quot;点击了品牌%@&quot;</span><span class="token punctuation">,</span>link_id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6)]))}const l=s(e,[["render",o],["__file","WKWebView-URL.html.vue"]]),u=JSON.parse('{"path":"/tutorial/iPhone/system/WKWebView-URL.html","title":"WKWebView拦截URL","lang":"zh-CN","frontmatter":{"title":"WKWebView拦截URL","date":"2017-05-27T00:00:00.000Z","category":["iOS"],"tag":["iOS"],"description":"本文介绍使用 WKWebView 拦截 url 进行原生界面跳转 3.gif3.gif 使用代理方法 decidePolicyForNavigationAction 自定义方法传过来 url 进行判断，需要 html 元素本身就有跳转链接，才可以拦截，如没有，拦截不到。下文 app://xxx 链接为自定义链接","head":[["meta",{"property":"og:url","content":"https://www.viptv.work/tutorial/iPhone/system/WKWebView-URL.html"}],["meta",{"property":"og:site_name","content":"VIPTV - 工作室"}],["meta",{"property":"og:title","content":"WKWebView拦截URL"}],["meta",{"property":"og:description","content":"本文介绍使用 WKWebView 拦截 url 进行原生界面跳转 3.gif3.gif 使用代理方法 decidePolicyForNavigationAction 自定义方法传过来 url 进行判断，需要 html 元素本身就有跳转链接，才可以拦截，如没有，拦截不到。下文 app://xxx 链接为自定义链接"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://storage1.cuntuku.com/2017/05/27/3.gif"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-26T07:14:53.000Z"}],["meta",{"property":"article:tag","content":"iOS"}],["meta",{"property":"article:published_time","content":"2017-05-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-26T07:14:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"WKWebView拦截URL\\",\\"image\\":[\\"https://storage1.cuntuku.com/2017/05/27/3.gif\\"],\\"datePublished\\":\\"2017-05-27T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-26T07:14:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Hefung\\",\\"url\\":\\"/about/us\\"}]}"]]},"headers":[],"git":{"createdTime":1732605293000,"updatedTime":1732605293000,"contributors":[{"name":"github-actions[bot]","email":"28900094+github-actions[bot]@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":0.77,"words":230},"filePathRelative":"tutorial/iPhone/system/WKWebView-URL.md","localizedDate":"2017年5月27日","excerpt":"","autoDesc":true}');export{l as comp,u as data};
