import{_ as s,c as a,f as e,o as t}from"./app-C2igzoW0.js";const p={};function l(c,n){return t(),a("div",null,n[0]||(n[0]=[e(`<blockquote><p>今天项目里出现一个问题，就是做一个列表选择，然后点击导航栏的确定按钮返回上级界面，并把选择的 cell 数据传递到上级界面。再使用 accessoryType 属性标记单元格之后会出现重用问题。</p></blockquote><h2 id="解决办法" tabindex="-1"><a class="header-anchor" href="#解决办法"><span>解决办法</span></a></h2><ul><li><p>把 tableView 的 allowsMultipleSelection 属性设为了 YES；</p><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line">_tableView<span class="token punctuation">.</span>allowsMultipleSelection <span class="token operator">=</span> YES<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>在 didSelectRowAtIndexPath 和 didDeselectRowAtIndexPath 方法里面使用了如下方法实现了点击单元格然后用 check mark 标记的方式。</p></li></ul><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line"><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>tableView<span class="token punctuation">:</span><span class="token punctuation">(</span>UITableView <span class="token operator">*</span><span class="token punctuation">)</span>tableView didSelectRowAtIndexPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSIndexPath <span class="token operator">*</span><span class="token punctuation">)</span>indexPath <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">      UITableViewCell <span class="token operator">*</span>cell <span class="token operator">=</span> <span class="token punctuation">[</span>tableView cellForRowAtIndexPath<span class="token punctuation">:</span>indexPath<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">	  cell<span class="token punctuation">.</span>accessoryType <span class="token operator">=</span> UITableViewCellAccessoryCheckmark<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>tableView<span class="token punctuation">:</span><span class="token punctuation">(</span>UITableView <span class="token operator">*</span><span class="token punctuation">)</span>tableView didDeselectRowAtIndexPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSIndexPath <span class="token operator">*</span><span class="token punctuation">)</span>indexPath <span class="token punctuation">{</span></span>
<span class="line">	<span class="token punctuation">[</span>tableView cellForRowAtIndexPath<span class="token punctuation">:</span>indexPath<span class="token punctuation">]</span><span class="token punctuation">.</span>accessoryType <span class="token operator">=</span> UITableViewCellAccessoryNone<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重点来了-两种思路" tabindex="-1"><a class="header-anchor" href="#重点来了-两种思路"><span>重点来了 两种思路</span></a></h3><ul><li>记录选择的 indexpath</li></ul><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line"> 	<span class="token comment">// 1.设一个NSMutableArray属性，元素个数跟你的_dataArray一样，初始化里面存的都是0。</span></span>
<span class="line"></span>
<span class="line">	 NSMutableArray<span class="token operator">*</span> selectionArray <span class="token operator">=</span> <span class="token punctuation">[</span>NSMutableArray array<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	 <span class="token keyword">for</span> <span class="token punctuation">(</span>NSInteger i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _dataArray<span class="token punctuation">.</span>count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    	<span class="token punctuation">[</span>selectionArray addObject<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 0 表示未选中，1 表示选中了</span></span>
<span class="line">	 <span class="token punctuation">}</span></span>
<span class="line">	 <span class="token keyword">self</span><span class="token punctuation">.</span>selectionArray <span class="token operator">=</span> selectionArray<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">   <span class="token comment">// 2.在 didSelectRowAtIndexPath:里</span></span>
<span class="line"></span>
<span class="line">	 <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>selectionArray replaceObjectAtIndex<span class="token punctuation">:</span>indexPath<span class="token punctuation">.</span>row withObject<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">	 <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>tableView reloadData<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">   <span class="token comment">// 3.在 didDeselectRowAtIndexPath里：</span></span>
<span class="line"></span>
<span class="line">	 <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>selectionArray replaceObjectAtIndex<span class="token punctuation">:</span>indexPath<span class="token punctuation">.</span>row withObject<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">	 <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>tableView reloadData<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">   <span class="token comment">// 4.在 cellForRow里：</span></span>
<span class="line">   </span>
<span class="line">	UITableViewCell <span class="token operator">*</span>cell <span class="token operator">=</span> <span class="token punctuation">[</span>tableView dequeueReusableCellWithIdentifier<span class="token punctuation">:</span>identifier<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	cell<span class="token punctuation">.</span>textLabel<span class="token punctuation">.</span>text <span class="token operator">=</span> _dataArray<span class="token punctuation">[</span>indexPath<span class="token punctuation">.</span>row<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	NSInteger selected <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>selectionArray<span class="token punctuation">[</span>indexPath<span class="token punctuation">.</span>row<span class="token punctuation">]</span> IntegerValue<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword">if</span> <span class="token punctuation">(</span>selected <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    cell<span class="token punctuation">.</span>accessoryType <span class="token operator">=</span> UITableViewCellAccessoryNone<span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    	cell<span class="token punctuation">.</span>accessoryType <span class="token operator">=</span> UITableViewCellAccessoryCheckmark<span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword">return</span> cell<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>利用 cell 的 selected 属性</p><ul><li>继承 UITableViewCell，在 setSeleted:animated:方法里面，根据选择状态，修改 accessoryType</li></ul></li></ul><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line">	 <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>setSelected<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>selected animated<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated <span class="token punctuation">{</span></span>
<span class="line">    	 <span class="token punctuation">[</span><span class="token keyword">super</span> setSelected<span class="token punctuation">:</span>selected animated<span class="token punctuation">:</span>animated<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">		 <span class="token keyword">self</span><span class="token punctuation">.</span>accessoryType <span class="token operator">=</span> selected<span class="token operator">?</span>UITableViewCellAccessoryCheckmark<span class="token punctuation">:</span>UITableViewCellAccessoryNone<span class="token punctuation">;</span></span>
<span class="line">		 <span class="token comment">// Configure the view for the selected state</span></span>
<span class="line">	 <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">	<span class="token comment">// 在 cellForRow里：</span></span>
<span class="line">	cell<span class="token punctuation">.</span>accessoryType <span class="token operator">=</span> cell<span class="token punctuation">.</span>selected<span class="token operator">?</span>UITableViewCellAccessoryCheckmark<span class="token punctuation">:</span>UITableViewCellAccessoryNone<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="至此已完美解决因为复用所导致的问题" tabindex="-1"><a class="header-anchor" href="#至此已完美解决因为复用所导致的问题"><span>至此已完美解决因为复用所导致的问题</span></a></h3><div class="language-objc line-numbers-mode" data-highlighter="prismjs" data-ext="objc" data-title="objc"><pre><code><span class="line">	<span class="token comment">// 设置tableView可不可以选中</span></span>
<span class="line">    <span class="token keyword">self</span><span class="token punctuation">.</span>tableView<span class="token punctuation">.</span>allowsSelection <span class="token operator">=</span> NO<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 允许tableview多选</span></span>
<span class="line">    <span class="token keyword">self</span><span class="token punctuation">.</span>tableView<span class="token punctuation">.</span>allowsMultipleSelection <span class="token operator">=</span> YES<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 编辑模式下是否可以选中</span></span>
<span class="line">    <span class="token keyword">self</span><span class="token punctuation">.</span>tableView<span class="token punctuation">.</span>allowsSelectionDuringEditing <span class="token operator">=</span> NO<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 编辑模式下是否可以多选</span></span>
<span class="line">    <span class="token keyword">self</span><span class="token punctuation">.</span>tableView<span class="token punctuation">.</span>allowsMultipleSelectionDuringEditing <span class="token operator">=</span> YES<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 获取被选中的所有行</span></span>
<span class="line">     <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>tableView indexPathsForSelectedRows<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 获取当前可见的行</span></span>
<span class="line">     <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>tableView indexPathsForVisibleRows<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11)]))}const o=s(p,[["render",l],["__file","cell复用-accessoryType解决办法.html.vue"]]),u=JSON.parse('{"path":"/tutorial/iPhone/ui/cell%E5%A4%8D%E7%94%A8-accessoryType%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95.html","title":"Cell的accessoryType属性标记单元格之后，出现的重用问题","lang":"zh-CN","frontmatter":{"title":"Cell的accessoryType属性标记单元格之后，出现的重用问题","date":"2017-02-13T00:00:00.000Z","category":["iOS"],"tag":["iOS","Bug录"],"description":"今天项目里出现一个问题，就是做一个列表选择，然后点击导航栏的确定按钮返回上级界面，并把选择的 cell 数据传递到上级界面。再使用 accessoryType 属性标记单元格之后会出现重用问题。 解决办法 把 tableView 的 allowsMultipleSelection 属性设为了 YES； 在 didSelectRowAtIndexPath...","head":[["meta",{"property":"og:url","content":"https://www.viptv.work/tutorial/iPhone/ui/cell%E5%A4%8D%E7%94%A8-accessoryType%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95.html"}],["meta",{"property":"og:site_name","content":"VIPTV - 工作室"}],["meta",{"property":"og:title","content":"Cell的accessoryType属性标记单元格之后，出现的重用问题"}],["meta",{"property":"og:description","content":"今天项目里出现一个问题，就是做一个列表选择，然后点击导航栏的确定按钮返回上级界面，并把选择的 cell 数据传递到上级界面。再使用 accessoryType 属性标记单元格之后会出现重用问题。 解决办法 把 tableView 的 allowsMultipleSelection 属性设为了 YES； 在 didSelectRowAtIndexPath..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-26T12:15:40.000Z"}],["meta",{"property":"article:tag","content":"iOS"}],["meta",{"property":"article:tag","content":"Bug录"}],["meta",{"property":"article:published_time","content":"2017-02-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-26T12:15:40.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Cell的accessoryType属性标记单元格之后，出现的重用问题\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2017-02-13T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-26T12:15:40.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Hefung\\",\\"url\\":\\"/about/us\\"}]}"]]},"headers":[{"level":2,"title":"解决办法","slug":"解决办法","link":"#解决办法","children":[{"level":3,"title":"重点来了 两种思路","slug":"重点来了-两种思路","link":"#重点来了-两种思路","children":[]},{"level":3,"title":"至此已完美解决因为复用所导致的问题","slug":"至此已完美解决因为复用所导致的问题","link":"#至此已完美解决因为复用所导致的问题","children":[]}]}],"git":{"createdTime":1732623340000,"updatedTime":1732623340000,"contributors":[{"name":"github-actions[bot]","email":"28900094+github-actions[bot]@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":1.52,"words":455},"filePathRelative":"tutorial/iPhone/ui/cell复用-accessoryType解决办法.md","localizedDate":"2017年2月13日","excerpt":"","autoDesc":true}');export{o as comp,u as data};
